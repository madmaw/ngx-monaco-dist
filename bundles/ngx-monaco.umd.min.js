!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("rxjs/Subject"),require("rxjs/Observable")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","rxjs/Subject","rxjs/Observable"],e):e(t["ngx-monaco"]={},t.ng.core,t.ng.common,t.Rx,t.Rx)}(this,function(t,i,e,r,o){"use strict";var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s(t,e){return t(e={exports:{}},e.exports),e.exports}var c,a={errorObject:{e:{}}};function u(){try{return c.apply(this,arguments)}catch(t){return a.errorObject.e=t,a.errorObject}}var l={tryCatch:function(t){return c=t,u}};var p={isFunction:function(t){return"function"==typeof t}},f={isArray:Array.isArray||function(t){return t&&"number"==typeof t.length}};var b={isObject:function(t){return null!=t&&"object"==typeof t}},h=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},d={UnsubscriptionError:function(i){function t(t){i.call(this),this.errors=t;var e=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"");this.name=e.name="UnsubscriptionError",this.stack=e.stack,this.message=e.message}return h(t,i),t}(Error)};function y(t){return t.reduce(function(t,e){return t.concat(e instanceof d.UnsubscriptionError?e.errors:e)},[])}var v={Subscription:function(){function r(t){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}var t;return r.prototype.unsubscribe=function(){var t,e=!1;if(!this.closed){var i=this._parent,r=this._parents,o=this._unsubscribe,n=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var s=-1,c=r?r.length:0;i;)i.remove(this),i=++s<c&&r[s]||null;if(p.isFunction(o))l.tryCatch(o).call(this)===a.errorObject&&(e=!0,t=t||(a.errorObject.e instanceof d.UnsubscriptionError?y(a.errorObject.e.errors):[a.errorObject.e]));if(f.isArray(n))for(s=-1,c=n.length;++s<c;){var u=n[s];if(b.isObject(u))if(l.tryCatch(u.unsubscribe).call(u)===a.errorObject){e=!0,t=t||[];var h=a.errorObject.e;h instanceof d.UnsubscriptionError?t=t.concat(y(h.errors)):t.push(h)}}if(e)throw new d.UnsubscriptionError(t)}},r.prototype.add=function(t){if(!t||t===r.EMPTY)return r.EMPTY;if(t===this)return this;var e=t;switch(typeof t){case"function":e=new r(t);case"object":if(e.closed||"function"!=typeof e.unsubscribe)return e;if(this.closed)return e.unsubscribe(),e;if("function"!=typeof e._addParent){var i=e;(e=new r)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(e),e._addParent(this),e},r.prototype.remove=function(t){var e=this._subscriptions;if(e){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}},r.prototype._addParent=function(t){var e=this._parent,i=this._parents;e&&e!==t?i?-1===i.indexOf(t)&&i.push(t):this._parents=[t]:this._parent=t},r.EMPTY=((t=new r).closed=!0,t),r}()},_={empty:{closed:!0,next:function(t){},error:function(t){throw t},complete:function(){}}},x="undefined"!=typeof window&&window,w="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,m=x||void 0!==n&&n||w,S=m;!function(){if(!m)throw new Error("RxJS could not find any global context (window, self, global)")}();var O={root:S},g=s(function(t,e){var i=O.root.Symbol;e.rxSubscriber="function"==typeof i&&"function"==typeof i["for"]?i["for"]("rxSubscriber"):"@@rxSubscriber",e.$$rxSubscriber=e.rxSubscriber}),j=(g.rxSubscriber,g.$$rxSubscriber,n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),E=function(n){function o(t,e,i){switch(n.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=_.empty;break;case 1:if(!t){this.destination=_.empty;break}if("object"==typeof t){if((o=t)instanceof E||"syncErrorThrowable"in o&&o[g.rxSubscriber]){var r=t[g.rxSubscriber]();this.syncErrorThrowable=r.syncErrorThrowable,(this.destination=r).add(this)}else this.syncErrorThrowable=!0,this.destination=new P(this,t);break}default:this.syncErrorThrowable=!0,this.destination=new P(this,t,e,i)}var o}return j(o,n),o.prototype[g.rxSubscriber]=function(){return this},o.create=function(t,e,i){var r=new o(t,e,i);return r.syncErrorThrowable=!1,r},o.prototype.next=function(t){this.isStopped||this._next(t)},o.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},o.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},o.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this))},o.prototype._next=function(t){this.destination.next(t)},o.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},o.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},o.prototype._unsubscribeAndRecycle=function(){var t=this._parent,e=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=t,this._parents=e,this},o}(v.Subscription),T=E,P=function(s){function t(t,e,i,r){var o;s.call(this),this._parentSubscriber=t;var n=this;p.isFunction(e)?o=e:e&&(o=e.next,i=e.error,r=e.complete,e!==_.empty&&(n=Object.create(e),p.isFunction(n.unsubscribe)&&this.add(n.unsubscribe.bind(n)),n.unsubscribe=this.unsubscribe.bind(this))),this._context=n,this._next=o,this._error=i,this._complete=r}return j(t,s),t.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},t.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber;if(this._error)e.syncErrorThrowable?this.__tryOrSetError(e,this._error,t):this.__tryOrUnsub(this._error,t),this.unsubscribe();else{if(!e.syncErrorThrowable)throw this.unsubscribe(),t;e.syncErrorValue=t,e.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var i=function(){return t._complete.call(t._context)};e.syncErrorThrowable?this.__tryOrSetError(e,i):this.__tryOrUnsub(i),this.unsubscribe()}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(i){throw this.unsubscribe(),i}},t.prototype.__tryOrSetError=function(t,e,i){try{e.call(this._context,i)}catch(r){return t.syncErrorValue=r,t.syncErrorThrown=!0}return!1},t.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},t}(E);var C={Subscriber:T},N=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},V={OuterSubscriber:function(t){function e(){t.apply(this,arguments)}return N(e,t),e.prototype.notifyNext=function(t,e,i,r,o){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(C.Subscriber)},R={isArrayLike:function(t){return t&&"number"==typeof t.length}};var I={isPromise:function(t){return t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}};var k={toSubscriber:function(t,e,i){if(t){if(t instanceof C.Subscriber)return t;if(t[g.rxSubscriber])return t[g.rxSubscriber]()}return t||e||i?new C.Subscriber(t,e,i):new C.Subscriber(_.empty)}},A=s(function(t,e){function i(t){var e,i=t.Symbol;return"function"==typeof i?i.observable?e=i.observable:(e=i("observable"),i.observable=e):e="@@observable",e}e.getSymbolObservable=i,e.observable=i(O.root),e.$$observable=e.observable});A.getSymbolObservable,A.observable,A.$$observable;var M={noop:function(){}};function F(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(t,e){return e(t)},t)}:M.noop}var z={pipe:function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return F(t)},pipeFromArray:F},B={Observable:function(){function i(t){this._isScalar=!1,t&&(this._subscribe=t)}return i.prototype.lift=function(t){var e=new i;return e.source=this,e.operator=t,e},i.prototype.subscribe=function(t,e,i){var r=this.operator,o=k.toSubscriber(t,e,i);if(r?r.call(o,this.source):o.add(this.source||!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},i.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.syncErrorThrown=!0,t.syncErrorValue=e,t.error(e)}},i.prototype.forEach=function(o,t){var e=this;if(t||(O.root.Rx&&O.root.Rx.config&&O.root.Rx.config.Promise?t=O.root.Rx.config.Promise:O.root.Promise&&(t=O.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,i){var r;r=e.subscribe(function(t){if(r)try{o(t)}catch(e){i(e),r.unsubscribe()}else o(t)},i,t)})},i.prototype._subscribe=function(t){return this.source.subscribe(t)},i.prototype[A.observable]=function(){return this},i.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];return 0===t.length?this:z.pipeFromArray(t)(this)},i.prototype.toPromise=function(t){var r=this;if(t||(O.root.Rx&&O.root.Rx.config&&O.root.Rx.config.Promise?t=O.root.Rx.config.Promise:O.root.Promise&&(t=O.root.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,e){var i;r.subscribe(function(t){return i=t},function(t){return e(t)},function(){return t(i)})})},i.create=function(t){return new i(t)},i}()},D=s(function(t,e){function i(t){var e=t.Symbol;if("function"==typeof e)return e.iterator||(e.iterator=e("iterator polyfill")),e.iterator;var i=t.Set;if(i&&"function"==typeof(new i)["@@iterator"])return"@@iterator";var r=t.Map;if(r)for(var o=Object.getOwnPropertyNames(r.prototype),n=0;n<o.length;++n){var s=o[n];if("entries"!==s&&"size"!==s&&r.prototype[s]===r.prototype.entries)return s}return"@@iterator"}e.symbolIteratorPonyfill=i,e.iterator=i(O.root),e.$$iterator=e.iterator}),U=(D.symbolIteratorPonyfill,D.iterator,D.$$iterator,n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),W={InnerSubscriber:function(r){function t(t,e,i){r.call(this),this.parent=t,this.outerValue=e,this.outerIndex=i,this.index=0}return U(t,r),t.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},t.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(C.Subscriber)};var $={subscribeToResult:function(t,e,i,r){var o=new W.InnerSubscriber(t,i,r);if(o.closed)return null;if(e instanceof B.Observable)return e._isScalar?(o.next(e.value),o.complete(),null):(o.syncErrorThrowable=!0,e.subscribe(o));if(R.isArrayLike(e)){for(var n=0,s=e.length;n<s&&!o.closed;n++)o.next(e[n]);o.closed||o.complete()}else{if(I.isPromise(e))return e.then(function(t){o.closed||(o.next(t),o.complete())},function(t){return o.error(t)}).then(null,function(t){O.root.setTimeout(function(){throw t})}),o;if(e&&"function"==typeof e[D.iterator])for(var c=e[D.iterator]();;){var u=c.next();if(u.done){o.complete();break}if(o.next(u.value),o.closed)break}else if(e&&"function"==typeof e[A.observable]){var h=e[A.observable]();if("function"==typeof h.subscribe)return h.subscribe(new W.InnerSubscriber(t,i,r));o.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var p="You provided "+(b.isObject(e)?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.";o.error(new TypeError(p))}}return null}},Y=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},q=(function(i){function t(t,e){i.call(this,t),this.durationSelector=e,this.hasValue=!1}Y(t,i),t.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=l.tryCatch(this.durationSelector)(t);if(e===a.errorObject)this.destination.error(a.errorObject.e);else{var i=$.subscribeToResult(this,e);i.closed?this.clearThrottle():this.add(this.throttled=i)}}},t.prototype.clearThrottle=function(){var t=this.value,e=this.hasValue,i=this.throttled;i&&(this.remove(i),this.throttled=null,i.unsubscribe()),e&&(this.value=null,this.hasValue=!1,this.destination.next(t))},t.prototype.notifyNext=function(t,e,i,r){this.clearThrottle()},t.prototype.notifyComplete=function(){this.clearThrottle()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),L={Action:function(i){function t(t,e){i.call(this)}return q(t,i),t.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},t}(v.Subscription)},G=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},K={AsyncAction:function(i){function t(t,e){i.call(this,t,e),this.scheduler=t,this.work=e,this.pending=!1}return G(t,i),t.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t,this.pending=!0;var i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,e)),this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},t.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),O.root.setInterval(t.flush.bind(t,this),i)},t.prototype.recycleAsyncId=function(t,e,i){return void 0===i&&(i=0),null!==i&&this.delay===i&&!1===this.pending?e:O.root.clearInterval(e)&&undefined||undefined},t.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(t,e){var i=!1,r=undefined;try{this.work(t)}catch(o){i=!0,r=!!o&&o||new Error(o)}if(i)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,i=e.actions,r=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&i.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},t}(L.Action)},Q={Scheduler:function(){function i(t,e){void 0===e&&(e=i.now),this.SchedulerAction=t,this.now=e}return i.prototype.schedule=function(t,e,i){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(i,e)},i.now=Date.now?Date.now:function(){return+new Date},i}()},J=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},H={AsyncScheduler:function(t){function e(){t.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=undefined}return J(e,t),e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}},e}(Q.Scheduler)},Z={async:new H.AsyncScheduler(K.AsyncAction)};var X={isNumeric:function(t){return!f.isArray(t)&&0<=t-parseFloat(t)+1}};var tt={isScheduler:function(t){return t&&"function"==typeof t.schedule}};var et={isDate:function(t){return t instanceof Date&&!isNaN(+t)}},it=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},rt=(function(r){function o(t,e,i){void 0===t&&(t=0),r.call(this),this.period=-1,this.dueTime=0,X.isNumeric(e)?this.period=Number(e)<1?1:Number(e):tt.isScheduler(e)&&(i=e),tt.isScheduler(i)||(i=Z.async),this.scheduler=i,this.dueTime=et.isDate(t)?+t-this.scheduler.now():t}it(o,r),o.create=function(t,e,i){return void 0===t&&(t=0),new o(t,e,i)},o.dispatch=function(t){var e=t.index,i=t.period,r=t.subscriber;if(r.next(e),!r.closed){if(-1===i)return r.complete();t.index=e+1,this.schedule(t,i)}},o.prototype._subscribe=function(t){var e=this.period,i=this.dueTime;return this.scheduler.schedule(o.dispatch,i,{index:0,period:e,subscriber:t})}}(B.Observable),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ot=(function(i){function t(t,e){i.call(this,t),this.buffer=[],this.add($.subscribeToResult(this,e))}rt(t,i),t.prototype._next=function(t){this.buffer.push(t)},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.buffer;this.buffer=[],this.destination.next(n)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),nt=(function(i){function t(t,e){i.call(this,t),this.bufferSize=e,this.buffer=[]}ot(t,i),t.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},t.prototype._complete=function(){var t=this.buffer;0<t.length&&this.destination.next(t),i.prototype._complete.call(this)}}(C.Subscriber),function(r){function t(t,e,i){r.call(this,t),this.bufferSize=e,this.startBufferEvery=i,this.buffers=[],this.count=0}ot(t,r),t.prototype._next=function(t){var e=this.bufferSize,i=this.startBufferEvery,r=this.buffers,o=this.count;this.count++,o%i==0&&r.push([]);for(var n=r.length;n--;){var s=r[n];s.push(t),s.length===e&&(r.splice(n,1),this.destination.next(s))}},t.prototype._complete=function(){for(var t=this.buffers,e=this.destination;0<t.length;){var i=t.shift();0<i.length&&e.next(i)}r.prototype._complete.call(this)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),st=function(){this.buffer=[]};!function(h){function t(t,e,i,r,o){h.call(this,t),this.bufferTimeSpan=e,this.bufferCreationInterval=i,this.maxBufferSize=r,this.scheduler=o,this.contexts=[];var n=this.openContext();if(this.timespanOnly=null==i||i<0,this.timespanOnly){var s={subscriber:this,context:n,bufferTimeSpan:e};this.add(n.closeAction=o.schedule(ct,e,s))}else{var c={subscriber:this,context:n},u={bufferTimeSpan:e,bufferCreationInterval:i,subscriber:this,scheduler:o};this.add(n.closeAction=o.schedule(ht,e,c)),this.add(o.schedule(ut,i,u))}}nt(t,h),t.prototype._next=function(t){for(var e,i=this.contexts,r=i.length,o=0;o<r;o++){var n=i[o],s=n.buffer;s.push(t),s.length==this.maxBufferSize&&(e=n)}e&&this.onBufferFull(e)},t.prototype._error=function(t){this.contexts.length=0,h.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts,e=this.destination;0<t.length;){var i=t.shift();e.next(i.buffer)}h.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.contexts=null},t.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var i=this.bufferTimeSpan,r={subscriber:this,context:t,bufferTimeSpan:i};this.add(t.closeAction=this.scheduler.schedule(ct,i,r))}},t.prototype.openContext=function(){var t=new st;return this.contexts.push(t),t},t.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;0<=(e?e.indexOf(t):-1)&&e.splice(e.indexOf(t),1)}}(C.Subscriber);function ct(t){var e=t.subscriber,i=t.context;i&&e.closeContext(i),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function ut(t){var e=t.bufferCreationInterval,i=t.bufferTimeSpan,r=t.subscriber,o=t.scheduler,n=r.openContext();r.closed||(r.add(n.closeAction=o.schedule(ht,i,{subscriber:r,context:n})),this.schedule(t,e))}function ht(t){var e=t.subscriber,i=t.context;e.closeContext(i)}var pt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},at=(function(r){function t(t,e,i){r.call(this,t),this.openings=e,this.closingSelector=i,this.contexts=[],this.add($.subscribeToResult(this,e))}pt(t,r),t.prototype._next=function(t){for(var e=this.contexts,i=e.length,r=0;r<i;r++)e[r].buffer.push(t)},t.prototype._error=function(t){for(var e=this.contexts;0<e.length;){var i=e.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,r.prototype._error.call(this,t)},t.prototype._complete=function(){for(var t=this.contexts;0<t.length;){var e=t.shift();this.destination.next(e.buffer),e.subscription.unsubscribe(),e.buffer=null,e.subscription=null}this.contexts=null,r.prototype._complete.call(this)},t.prototype.notifyNext=function(t,e,i,r,o){t?this.closeBuffer(t):this.openBuffer(e)},t.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},t.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(i){this._error(i)}},t.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var i=t.buffer,r=t.subscription;this.destination.next(i),e.splice(e.indexOf(t),1),this.remove(r),r.unsubscribe()}},t.prototype.trySubscribe=function(t){var e=this.contexts,i=new v.Subscription,r={buffer:[],subscription:i};e.push(r);var o=$.subscribeToResult(this,t,r);!o||o.closed?this.closeBuffer(r):(o.context=r,this.add(o),i.add(o))}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),lt=(function(i){function t(t,e){i.call(this,t),this.closingSelector=e,this.subscribing=!1,this.openBuffer()}at(t,i),t.prototype._next=function(t){this.buffer.push(t)},t.prototype._complete=function(){var t=this.buffer;t&&this.destination.next(t),i.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.buffer=null,this.subscribing=!1},t.prototype.notifyNext=function(t,e,i,r,o){this.openBuffer()},t.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},t.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e=this.buffer;this.buffer&&this.destination.next(e),this.buffer=[];var i=l.tryCatch(this.closingSelector)();i===a.errorObject?this.error(a.errorObject.e):(t=new v.Subscription,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add($.subscribeToResult(this,i)),this.subscribing=!1)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ft=(function(r){function t(t,e,i){r.call(this,t),this.selector=e,this.caught=i}lt(t,r),t.prototype.error=function(t){if(!this.isStopped){var e=void 0;try{e=this.selector(t,this.caught)}catch(i){return void r.prototype.error.call(this,i)}this._unsubscribeAndRecycle(),this.add($.subscribeToResult(this,e))}}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),bt={ScalarObservable:function(i){function r(t,e){i.call(this),this.value=t,this.scheduler=e,this._isScalar=!0,e&&(this._isScalar=!1)}return ft(r,i),r.create=function(t,e){return new r(t,e)},r.dispatch=function(t){var e=t.done,i=t.value,r=t.subscriber;e?r.complete():(r.next(i),r.closed||(t.done=!0,this.schedule(t)))},r.prototype._subscribe=function(t){var e=this.value,i=this.scheduler;if(i)return i.schedule(r.dispatch,0,{done:!1,value:e,subscriber:t});t.next(e),t.closed||t.complete()},r}(B.Observable)},dt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},yt={EmptyObservable:function(e){function i(t){e.call(this),this.scheduler=t}return dt(i,e),i.create=function(t){return new i(t)},i.dispatch=function(t){t.subscriber.complete()},i.prototype._subscribe=function(t){var e=this.scheduler;if(e)return e.schedule(i.dispatch,0,{subscriber:t});t.complete()},i}(B.Observable)},vt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},_t={ArrayObservable:function(i){function n(t,e){i.call(this),this.array=t,(this.scheduler=e)||1!==t.length||(this._isScalar=!0,this.value=t[0])}return vt(n,i),n.create=function(t,e){return new n(t,e)},n.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];var i=t[t.length-1];tt.isScheduler(i)?t.pop():i=null;var r=t.length;return 1<r?new n(t,i):1===r?new bt.ScalarObservable(t[0],i):new yt.EmptyObservable(i)},n.dispatch=function(t){var e=t.array,i=t.index,r=t.count,o=t.subscriber;r<=i?o.complete():(o.next(e[i]),o.closed||(t.index=i+1,this.schedule(t)))},n.prototype._subscribe=function(t){var e=this.array,i=e.length,r=this.scheduler;if(r)return r.schedule(n.dispatch,0,{array:e,index:0,count:i,subscriber:t});for(var o=0;o<i&&!t.closed;o++)t.next(e[o]);t.complete()},n}(B.Observable)},xt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},wt={},mt=(function(i){function t(t,e){i.call(this,t),this.project=e,this.active=0,this.values=[],this.observables=[]}xt(t,i),t.prototype._next=function(t){this.values.push(wt),this.observables.push(t)},t.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var i=0;i<e;i++){var r=t[i];this.add($.subscribeToResult(this,r,r,i))}}},t.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.values,s=n[i],c=this.toRespond?s===wt?--this.toRespond:this.toRespond:0;n[i]=e,0===c&&(this.project?this._tryProject(n):this.destination.next(n.slice()))},t.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});function St(t){var e=t.value,i=t.subscriber;i.closed||(i.next(e),i.complete())}function Ot(t){var e=t.err,i=t.subscriber;i.closed||i.error(e)}var gt={PromiseObservable:function(i){function r(t,e){i.call(this),this.promise=t,this.scheduler=e}return mt(r,i),r.create=function(t,e){return new r(t,e)},r.prototype._subscribe=function(e){var i=this,t=this.promise,r=this.scheduler;if(null==r)this._isScalar?e.closed||(e.next(this.value),e.complete()):t.then(function(t){i.value=t,i._isScalar=!0,e.closed||(e.next(t),e.complete())},function(t){e.closed||e.error(t)}).then(null,function(t){O.root.setTimeout(function(){throw t})});else if(this._isScalar){if(!e.closed)return r.schedule(St,0,{value:this.value,subscriber:e})}else t.then(function(t){i.value=t,i._isScalar=!0,e.closed||e.add(r.schedule(St,0,{value:t,subscriber:e}))},function(t){e.closed||e.add(r.schedule(Ot,0,{err:t,subscriber:e}))}).then(null,function(t){O.root.setTimeout(function(){throw t})})},r}(B.Observable)},jt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Et=function(i){function o(t,e){if(i.call(this),this.scheduler=e,null==t)throw new Error("iterator cannot be null.");this.iterator=function(t){var e=t[D.iterator];if(!e&&"string"==typeof t)return new Tt(t);if(!e&&t.length!==undefined)return new Pt(t);if(!e)throw new TypeError("object is not iterable");return t[D.iterator]()}(t)}return jt(o,i),o.create=function(t,e){return new o(t,e)},o.dispatch=function(t){var e=t.index,i=t.hasError,r=t.iterator,o=t.subscriber;if(i)o.error(t.error);else{var n=r.next();n.done?o.complete():(o.next(n.value),t.index=e+1,o.closed?"function"==typeof r["return"]&&r["return"]():this.schedule(t))}},o.prototype._subscribe=function(t){var e=this.iterator,i=this.scheduler;if(i)return i.schedule(o.dispatch,0,{index:0,iterator:e,subscriber:t});for(;;){var r=e.next();if(r.done){t.complete();break}if(t.next(r.value),t.closed){"function"==typeof e["return"]&&e["return"]();break}}},o}(B.Observable),Tt=function(){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=t.length),this.str=t,this.idx=e,this.len=i}return t.prototype[D.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:undefined}},t}(),Pt=function(){function t(t,e,i){void 0===e&&(e=0),void 0===i&&(i=function(t){var e=+t.length;if(isNaN(e))return 0;if(0===e||(i=e,"number"!=typeof i||!O.root.isFinite(i)))return e;var i;if(r=e,o=+r,(e=(0===o?o:isNaN(o)?o:o<0?-1:1)*Math.floor(Math.abs(e)))<=0)return 0;var r,o;if(Ct<e)return Ct;return e}(t)),this.arr=t,this.idx=e,this.len=i}return t.prototype[D.iterator]=function(){return this},t.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:undefined}},t}();var Ct=Math.pow(2,53)-1;var Nt={IteratorObservable:Et},Vt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Rt={ArrayLikeObservable:function(i){function n(t,e){i.call(this),this.arrayLike=t,(this.scheduler=e)||1!==t.length||(this._isScalar=!0,this.value=t[0])}return Vt(n,i),n.create=function(t,e){var i=t.length;return 0===i?new yt.EmptyObservable:1===i?new bt.ScalarObservable(t[0],e):new n(t,e)},n.dispatch=function(t){var e=t.arrayLike,i=t.index,r=t.length,o=t.subscriber;o.closed||(r<=i?o.complete():(o.next(e[i]),t.index=i+1,this.schedule(t)))},n.prototype._subscribe=function(t){var e=this.arrayLike,i=this.scheduler,r=e.length;if(i)return i.schedule(n.dispatch,0,{arrayLike:e,index:0,length:r,subscriber:t});for(var o=0;o<r&&!t.closed;o++)t.next(e[o]);t.complete()},n}(B.Observable)},It={Notification:function(){function e(t,e,i){this.kind=t,this.value=e,this.error=i,this.hasValue="N"===t}return e.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},e.prototype["do"]=function(t,e,i){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return i&&i()}},e.prototype.accept=function(t,e,i){return t&&"function"==typeof t.next?this.observe(t):this["do"](t,e,i)},e.prototype.toObservable=function(){switch(this.kind){case"N":return B.Observable.of(this.value);case"E":return B.Observable["throw"](this.error);case"C":return B.Observable.empty()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",undefined,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",undefined),e}()},kt=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};var At=function(e,i){return void 0===i&&(i=0),function(t){return t.lift(new Mt(e,i))}},Mt=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new zt(t,this.scheduler,this.delay))},t}(),Ft=Mt,zt=function(r){function e(t,e,i){void 0===i&&(i=0),r.call(this,t),this.scheduler=e,this.delay=i}return kt(e,r),e.dispatch=function(t){var e=t.notification,i=t.destination;e.observe(i),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.add(this.scheduler.schedule(e.dispatch,this.delay,new Bt(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(It.Notification.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(It.Notification.createError(t))},e.prototype._complete=function(){this.scheduleMessage(It.Notification.createComplete())},e}(C.Subscriber),Bt=function(t,e){this.notification=t,this.destination=e},Dt={observeOn:At,ObserveOnOperator:Ft,ObserveOnSubscriber:zt,ObserveOnMessage:Bt},Ut=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Wt=(function(i){function r(t,e){i.call(this,null),this.ish=t,this.scheduler=e}Ut(r,i),r.create=function(t,e){if(null!=t){if("function"==typeof t[A.observable])return t instanceof B.Observable&&!e?t:new r(t,e);if(f.isArray(t))return new _t.ArrayObservable(t,e);if(I.isPromise(t))return new gt.PromiseObservable(t,e);if("function"==typeof t[D.iterator]||"string"==typeof t)return new Nt.IteratorObservable(t,e);if(R.isArrayLike(t))return new Rt.ArrayLikeObservable(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")},r.prototype._subscribe=function(t){var e=this.ish,i=this.scheduler;return null==i?e[A.observable]().subscribe(t):e[A.observable]().subscribe(new Dt.ObserveOnSubscriber(t,i,0))}}(B.Observable),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),$t=(function(o){function t(t,e,i,r){void 0===r&&(r=Number.POSITIVE_INFINITY),o.call(this,t),this.project=e,this.resultSelector=i,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}Wt(t,o),t.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},t.prototype._tryNext=function(t){var e,i=this.index++;try{e=this.project(t,i)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(e,t,i)},t.prototype._innerSub=function(t,e,i){this.add($.subscribeToResult(this,t,e,i))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},t.prototype.notifyNext=function(t,e,i,r,o){this.resultSelector?this._notifyResultSelector(t,e,i,r):this.destination.next(e)},t.prototype._notifyResultSelector=function(t,e,i,r){var o;try{o=this.resultSelector(t,e,i,r)}catch(n){return void this.destination.error(n)}this.destination.next(o)},t.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Yt=(function(r){function t(t,e,i){r.call(this,t),this.predicate=e,this.source=i,this.count=0,this.index=0}$t(t,r),t.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},t.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(i){return void this.destination.error(i)}e&&this.count++},t.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),qt=(function(i){function t(t,e){i.call(this,t),this.durationSelector=e,this.hasValue=!1,this.durationSubscription=null}Yt(t,i),t.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(i){this.destination.error(i)}},t.prototype._complete=function(){this.emitValue(),this.destination.complete()},t.prototype._tryNext=function(t,e){var i=this.durationSubscription;this.value=t,this.hasValue=!0,i&&(i.unsubscribe(),this.remove(i)),(i=$.subscribeToResult(this,e)).closed||this.add(this.durationSubscription=i)},t.prototype.notifyNext=function(t,e,i,r,o){this.emitValue()},t.prototype.notifyComplete=function(){this.emitValue()},t.prototype.emitValue=function(){if(this.hasValue){var t=this.value,e=this.durationSubscription;e&&(this.durationSubscription=null,e.unsubscribe(),this.remove(e)),this.value=null,this.hasValue=!1,i.prototype._next.call(this,t)}}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var Lt=function(e,i){return void 0===i&&(i=Z.async),function(t){return t.lift(new Gt(e,i))}},Gt=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Kt(t,this.dueTime,this.scheduler))},t}(),Kt=function(r){function t(t,e,i){r.call(this,t),this.dueTime=e,this.scheduler=i,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}return qt(t,r),t.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Qt,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){this.clearDebounce(),this.hasValue&&(this.destination.next(this.lastValue),this.lastValue=null,this.hasValue=!1)},t.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},t}(C.Subscriber);function Qt(t){t.debouncedNext()}var Jt={debounceTime:Lt},Ht=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Zt=(function(i){function t(t,e){i.call(this,t),this.defaultValue=e,this.isEmpty=!0}Ht(t,i),t.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Xt=(function(r){function e(t,e,i){r.call(this,t),this.delay=e,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}Zt(e,r),e.dispatch=function(t){for(var e=t.source,i=e.queue,r=t.scheduler,o=t.destination;0<i.length&&i[0].time-r.now()<=0;)i.shift().notification.observe(o);if(0<i.length){var n=Math.max(0,i[0].time-r.now());this.schedule(t,n)}else e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,i=new Xt(e.now()+this.delay,t);this.queue.push(i),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(It.Notification.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t)},e.prototype._complete=function(){this.scheduleNotification(It.Notification.createComplete())}}(C.Subscriber),function(t,e){this.time=t,this.notification=e}),te=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ee=(function(i){function t(t,e){i.call(this,t),this.delayDurationSelector=e,this.completed=!1,this.delayNotifierSubscriptions=[],this.values=[]}te(t,i),t.prototype.notifyNext=function(t,e,i,r,o){this.destination.next(t),this.removeSubscription(o),this.tryComplete()},t.prototype.notifyError=function(t,e){this._error(t)},t.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},t.prototype._next=function(t){try{var e=this.delayDurationSelector(t);e&&this.tryDelay(e,t)}catch(i){this.destination.error(i)}},t.prototype._complete=function(){this.completed=!0,this.tryComplete()},t.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t),i=null;return-1!==e&&(i=this.values[e],this.delayNotifierSubscriptions.splice(e,1),this.values.splice(e,1)),i},t.prototype.tryDelay=function(t,e){var i=$.subscribeToResult(this,t,e);i&&!i.closed&&(this.add(i),this.delayNotifierSubscriptions.push(i)),this.values.push(e)},t.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()}}(V.OuterSubscriber),function(i){function t(t,e){i.call(this),this.source=t,this.subscriptionDelay=e}te(t,i),t.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new ee(t,this.source))}}(B.Observable),function(i){function t(t,e){i.call(this),this.parent=t,this.source=e,this.sourceSubscribed=!1}return te(t,i),t.prototype._next=function(t){this.subscribeToSource()},t.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},t.prototype._complete=function(){this.subscribeToSource()},t.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},t}(C.Subscriber)),ie=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};!function(e){function t(t){e.call(this,t)}ie(t,e),t.prototype._next=function(t){t.observe(this.destination)}}(C.Subscriber);function re(){return function(){function t(){this._values=[]}return t.prototype.add=function(t){this.has(t)||this._values.push(t)},t.prototype.has=function(t){return-1!==this._values.indexOf(t)},Object.defineProperty(t.prototype,"size",{get:function(){return this._values.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._values.length=0},t}()}var oe={minimalSetImpl:re,Set:O.root.Set||re()},ne=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},se=(function(r){function t(t,e,i){r.call(this,t),this.keySelector=e,this.values=new oe.Set,i&&this.add($.subscribeToResult(this,i))}ne(t,r),t.prototype.notifyNext=function(t,e,i,r,o){this.values.clear()},t.prototype.notifyError=function(t,e){this._error(t)},t.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},t.prototype._useKeySelector=function(t){var e,i=this.destination;try{e=this.keySelector(t)}catch(r){return void i.error(r)}this._finalizeNext(e,t)},t.prototype._finalizeNext=function(t,e){var i=this.values;i.has(t)||(i.add(t),this.destination.next(e))}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var ce=function(e,i){return function(t){return t.lift(new ue(e,i))}},ue=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new he(t,this.compare,this.keySelector))},t}(),he=function(r){function t(t,e,i){r.call(this,t),this.keySelector=i,this.hasKey=!1,"function"==typeof e&&(this.compare=e)}return se(t,r),t.prototype.compare=function(t,e){return t===e},t.prototype._next=function(t){var e=t;if(this.keySelector&&(e=l.tryCatch(this.keySelector)(t))===a.errorObject)return this.destination.error(a.errorObject.e);var i=!1;if(this.hasKey){if((i=l.tryCatch(this.compare)(this.key,e))===a.errorObject)return this.destination.error(a.errorObject.e)}else this.hasKey=!0;!1===Boolean(i)&&(this.key=e,this.destination.next(t))},t}(C.Subscriber),pe={distinctUntilChanged:ce},ae=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},le={ArgumentOutOfRangeError:function(e){function t(){var t=e.call(this,"argument out of range");this.name=t.name="ArgumentOutOfRangeError",this.stack=t.stack,this.message=t.message}return ae(t,e),t}(Error)},fe=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},be=(function(r){function t(t,e,i){r.call(this,t),this.index=e,this.defaultValue=i}fe(t,r),t.prototype._next=function(t){0==this.index--&&(this.destination.next(t),this.destination.complete())},t.prototype._complete=function(){var t=this.destination;0<=this.index&&("undefined"!=typeof this.defaultValue?t.next(this.defaultValue):t.error(new le.ArgumentOutOfRangeError)),t.complete()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),de=(function(o){function t(t,e,i,r){o.call(this,t),this.predicate=e,this.thisArg=i,this.source=r,this.index=0,this.thisArg=i||this}be(t,o),t.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},t.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(i){return void this.destination.error(i)}e||this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ye=(function(e){function t(t){e.call(this,t),this.hasCompleted=!1,this.hasSubscription=!1}de(t,e),t.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add($.subscribeToResult(this,t)))},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},t.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ve=(function(r){function t(t,e,i){r.call(this,t),this.project=e,this.resultSelector=i,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}ye(t,r),t.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},t.prototype.tryNext=function(t){var e=this.index++,i=this.destination;try{var r=this.project(t,e);this.hasSubscription=!0,this.add($.subscribeToResult(this,r,t,e))}catch(o){i.error(o)}},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.resultSelector,s=this.destination;n?this.trySelectResult(t,e,i,r):s.next(e)},t.prototype.trySelectResult=function(t,e,i,r){var o=this.resultSelector,n=this.destination;try{var s=o(t,e,i,r);n.next(s)}catch(c){n.error(c)}},t.prototype.notifyError=function(t){this.destination.error(t)},t.prototype.notifyComplete=function(t){this.remove(t),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),_e=(function(o){function n(t,e,i,r){o.call(this,t),this.project=e,this.concurrent=i,this.scheduler=r,this.index=0,this.active=0,this.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(this.buffer=[])}ve(n,o),n.dispatch=function(t){var e=t.subscriber,i=t.result,r=t.value,o=t.index;e.subscribeToProjection(i,r,o)},n.prototype._next=function(t){var e=this.destination;if(e.closed)this._complete();else{var i=this.index++;if(this.active<this.concurrent){e.next(t);var r=l.tryCatch(this.project)(t,i);if(r===a.errorObject)e.error(a.errorObject.e);else if(this.scheduler){var o={subscriber:this,result:r,value:t,index:i};this.add(this.scheduler.schedule(n.dispatch,0,o))}else this.subscribeToProjection(r,t,i)}else this.buffer.push(t)}},n.prototype.subscribeToProjection=function(t,e,i){this.active++,this.add($.subscribeToResult(this,t,e,i))},n.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete()},n.prototype.notifyNext=function(t,e,i,r,o){this._next(e)},n.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e&&0<e.length&&this._next(e.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var xe=function(e,i){return function(t){return t.lift(new we(e,i))}},we=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new me(t,this.predicate,this.thisArg))},t}(),me=function(r){function t(t,e,i){r.call(this,t),this.predicate=e,this.thisArg=i,this.count=0}return _e(t,r),t.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}e&&this.destination.next(t)},t}(C.Subscriber),Se={filter:xe},Oe=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ge=(function(i){function t(t,e){i.call(this,t),this.add(new v.Subscription(e))}Oe(t,i)}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),je=(function(n){function t(t,e,i,r,o){n.call(this,t),this.predicate=e,this.source=i,this.yieldIndex=r,this.thisArg=o,this.index=0}ge(t,n),t.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},t.prototype._next=function(t){var e=this.predicate,i=this.thisArg,r=this.index++;try{e.call(i||this,t,r,this.source)&&this.notifyComplete(this.yieldIndex?r:t)}catch(o){this.destination.error(o)}},t.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:undefined)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ee={EmptyError:function(e){function t(){var t=e.call(this,"no elements in sequence");this.name=t.name="EmptyError",this.stack=t.stack,this.message=t.message}return je(t,e),t}(Error)},Te=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Pe=(function(n){function t(t,e,i,r,o){n.call(this,t),this.predicate=e,this.resultSelector=i,this.defaultValue=r,this.source=o,this.index=0,this.hasCompleted=!1,this._emitted=!1}Te(t,n),t.prototype._next=function(t){var e=this.index++;this.predicate?this._tryPredicate(t,e):this._emit(t,e)},t.prototype._tryPredicate=function(t,e){var i;try{i=this.predicate(t,e,this.source)}catch(r){return void this.destination.error(r)}i&&this._emit(t,e)},t.prototype._emit=function(t,e){this.resultSelector?this._tryResultSelector(t,e):this._emitFinal(t)},t.prototype._tryResultSelector=function(t,e){var i;try{i=this.resultSelector(t,e)}catch(r){return void this.destination.error(r)}this._emitFinal(i)},t.prototype._emitFinal=function(t){var e=this.destination;this._emitted||(this._emitted=!0,e.next(t),e.complete(),this.hasCompleted=!0)},t.prototype._complete=function(){var t=this.destination;this.hasCompleted||"undefined"==typeof this.defaultValue?this.hasCompleted||t.error(new Ee.EmptyError):(t.next(this.defaultValue),t.complete())}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ce={ObjectUnsubscribedError:function(e){function t(){var t=e.call(this,"object unsubscribed");this.name=t.name="ObjectUnsubscribedError",this.stack=t.stack,this.message=t.message}return Pe(t,e),t}(Error)},Ne=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ve={SubjectSubscription:function(i){function t(t,e){i.call(this),this.subject=t,this.subscriber=e,this.closed=!1}return Ne(t,i),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var i=e.indexOf(this.subscriber);-1!==i&&e.splice(i,1)}}},t}(v.Subscription)},Re=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ie=function(e){function t(t){e.call(this,t),this.destination=t}return Re(t,e),t}(C.Subscriber),ke=Ie,Ae=function(e){function t(){e.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return Re(t,e),t.prototype[g.rxSubscriber]=function(){return new Ie(this)},t.prototype.lift=function(t){var e=new Fe(this,this);return e.operator=t,e},t.prototype.next=function(t){if(this.closed)throw new Ce.ObjectUnsubscribedError;if(!this.isStopped)for(var e=this.observers,i=e.length,r=e.slice(),o=0;o<i;o++)r[o].next(t)},t.prototype.error=function(t){if(this.closed)throw new Ce.ObjectUnsubscribedError;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,i=e.length,r=e.slice(),o=0;o<i;o++)r[o].error(t);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new Ce.ObjectUnsubscribedError;this.isStopped=!0;for(var t=this.observers,e=t.length,i=t.slice(),r=0;r<e;r++)i[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new Ce.ObjectUnsubscribedError;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(t){if(this.closed)throw new Ce.ObjectUnsubscribedError;return this.hasError?(t.error(this.thrownError),v.Subscription.EMPTY):this.isStopped?(t.complete(),v.Subscription.EMPTY):(this.observers.push(t),new Ve.SubjectSubscription(this,t))},t.prototype.asObservable=function(){var t=new B.Observable;return t.source=this,t},t.create=function(t,e){return new Fe(t,e)},t}(B.Observable),Me=Ae,Fe=function(i){function t(t,e){i.call(this),this.destination=t,this.source=e}return Re(t,i),t.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},t.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},t.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},t.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):v.Subscription.EMPTY},t}(Ae),ze={SubjectSubscriber:ke,Subject:Me,AnonymousSubject:Fe},Be={MapPolyfill:function(){function t(){this.size=0,this._values=[],this._keys=[]}return t.prototype.get=function(t){var e=this._keys.indexOf(t);return-1===e?undefined:this._values[e]},t.prototype.set=function(t,e){var i=this._keys.indexOf(t);return-1===i?(this._keys.push(t),this._values.push(e),this.size++):this._values[i]=e,this},t.prototype["delete"]=function(t){var e=this._keys.indexOf(t);return-1!==e&&(this._values.splice(e,1),this._keys.splice(e,1),this.size--,!0)},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this.size=0},t.prototype.forEach=function(t,e){for(var i=0;i<this.size;i++)t.call(e,this._values[i],this._keys[i])},t}()},De={Map:O.root.Map||Be.MapPolyfill},Ue={FastMap:function(){function t(){this.values={}}return t.prototype["delete"]=function(t){return!(this.values[t]=null)},t.prototype.set=function(t,e){return this.values[t]=e,this},t.prototype.get=function(t){return this.values[t]},t.prototype.forEach=function(t,e){var i=this.values;for(var r in i)i.hasOwnProperty(r)&&null!==i[r]&&t.call(e,i[r],r)},t.prototype.clear=function(){this.values={}},t}()},We=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},$e=(function(n){function t(t,e,i,r,o){n.call(this,t),this.keySelector=e,this.elementSelector=i,this.durationSelector=r,this.subjectSelector=o,this.groups=null,this.attemptedToUnsubscribe=!1,this.count=0}We(t,n),t.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(i){return void this.error(i)}this._group(t,e)},t.prototype._group=function(t,e){var i=this.groups;i||(i=this.groups="string"==typeof e?new Ue.FastMap:new De.Map);var r,o=i.get(e);if(this.elementSelector)try{r=this.elementSelector(t)}catch(c){this.error(c)}else r=t;if(!o){o=this.subjectSelector?this.subjectSelector():new ze.Subject,i.set(e,o);var n=new Ye(e,o,this);if(this.destination.next(n),this.durationSelector){var s=void 0;try{s=this.durationSelector(new Ye(e,o))}catch(c){return void this.error(c)}this.add(s.subscribe(new $e(e,o,this)))}}o.closed||o.next(r)},t.prototype._error=function(i){var t=this.groups;t&&(t.forEach(function(t,e){t.error(i)}),t.clear()),this.destination.error(i)},t.prototype._complete=function(){var t=this.groups;t&&(t.forEach(function(t,e){t.complete()}),t.clear()),this.destination.complete()},t.prototype.removeGroup=function(t){this.groups["delete"](t)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&n.prototype.unsubscribe.call(this))}}(C.Subscriber),function(r){function t(t,e,i){r.call(this,e),this.key=t,this.group=e,this.parent=i}return We(t,r),t.prototype._next=function(t){this.complete()},t.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},t}(C.Subscriber)),Ye=function(r){function t(t,e,i){r.call(this),this.key=t,this.groupSubject=e,this.refCountSubscription=i}return We(t,r),t.prototype._subscribe=function(t){var e=new v.Subscription,i=this.refCountSubscription,r=this.groupSubject;return i&&!i.closed&&e.add(new qe(i)),e.add(r.subscribe(t)),e},t}(B.Observable),qe=function(e){function t(t){e.call(this),(this.parent=t).count++}return We(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}(v.Subscription),Le=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ge=(function(t){function e(){t.apply(this,arguments)}Le(e,t),e.prototype._next=function(t){M.noop()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ke=(function(e){function t(t){e.call(this,t)}Ge(t,e),t.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},t.prototype._next=function(t){this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Qe=(function(n){function t(t,e,i,r,o){n.call(this,t),this.predicate=e,this.resultSelector=i,this.defaultValue=r,this.source=o,this.hasValue=!1,void(this.index=0)!==r&&(this.lastValue=r,this.hasValue=!0)}Ke(t,n),t.prototype._next=function(t){var e=this.index++;if(this.predicate)this._tryPredicate(t,e);else{if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},t.prototype._tryPredicate=function(t,e){var i;try{i=this.predicate(t,e,this.source)}catch(r){return void this.destination.error(r)}if(i){if(this.resultSelector)return void this._tryResultSelector(t,e);this.lastValue=t,this.hasValue=!0}},t.prototype._tryResultSelector=function(t,e){var i;try{i=this.resultSelector(t,e)}catch(r){return void this.destination.error(r)}this.lastValue=i,this.hasValue=!0},t.prototype._complete=function(){var t=this.destination;this.hasValue?(t.next(this.lastValue),t.complete()):t.error(new Ee.EmptyError)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var Je=function(e,i){return function(t){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return t.lift(new He(e,i))}},He=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new Xe(t,this.project,this.thisArg))},t}(),Ze=He,Xe=function(r){function t(t,e,i){r.call(this,t),this.project=e,this.count=0,this.thisArg=i||this}return Qe(t,r),t.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(i){return void this.destination.error(i)}this.destination.next(e)},t}(C.Subscriber),ti={map:Je,MapOperator:Ze},ei=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},ii=(function(i){function t(t,e){i.call(this,t),this.value=e}ei(t,i),t.prototype._next=function(t){this.destination.next(this.value)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ri=(function(e){function t(t){e.call(this,t)}ii(t,e),t.prototype._next=function(t){this.destination.next(It.Notification.createNext(t))},t.prototype._error=function(t){var e=this.destination;e.next(It.Notification.createError(t)),e.complete()},t.prototype._complete=function(){var t=this.destination;t.next(It.Notification.createComplete()),t.complete()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),oi=(function(o){function t(t,e,i,r){o.call(this,t),this.accumulator=e,this._seed=i,this.hasSeed=r,this.index=0}ri(t,o),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),t.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},t.prototype._tryNext=function(t){var e,i=this.index++;try{e=this.accumulator(this.seed,t,i)}catch(r){this.destination.error(r)}this.seed=e,this.destination.next(e)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ni=(function(i){function t(t,e){i.call(this,t),this.total=e,this.ring=new Array,this.count=0}oi(t,i),t.prototype._next=function(t){var e=this.ring,i=this.total,r=this.count++;e.length<i?e.push(t):e[r%i]=t},t.prototype._complete=function(){var t=this.destination,e=this.count;if(0<e)for(var i=this.count>=this.total?this.total:this.count,r=this.ring,o=0;o<i;o++){var n=e++%i;t.next(r[n])}t.complete()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),si=(function(o){function t(t,e,i,r){void 0===r&&(r=Number.POSITIVE_INFINITY),o.call(this,t),this.ish=e,this.resultSelector=i,this.concurrent=r,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}ni(t,o),t.prototype._next=function(t){if(this.active<this.concurrent){var e=this.resultSelector,i=this.index++,r=this.ish,o=this.destination;this.active++,this._innerSub(r,o,e,t,i)}else this.buffer.push(t)},t.prototype._innerSub=function(t,e,i,r,o){this.add($.subscribeToResult(this,t,r,o))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.resultSelector,s=this.destination;n?this.trySelectResult(t,e,i,r):s.next(e)},t.prototype.trySelectResult=function(t,e,i,r){var o,n=this.resultSelector,s=this.destination;try{o=n(t,e,i,r)}catch(c){return void s.error(c)}s.next(o)},t.prototype.notifyError=function(t){this.destination.error(t)},t.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),ci=(function(o){function t(t,e,i,r){o.call(this,t),this.accumulator=e,this.acc=i,this.concurrent=r,this.hasValue=!1,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}si(t,o),t.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,i=l.tryCatch(this.accumulator)(this.acc,t),r=this.destination;i===a.errorObject?r.error(a.errorObject.e):(this.active++,this._innerSub(i,t,e))}else this.buffer.push(t)},t.prototype._innerSub=function(t,e,i){this.add($.subscribeToResult(this,t,e,i))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.destination;this.acc=e,this.hasValue=!0,n.next(e)},t.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,0<e.length?this._next(e.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var ui=function(){return function(t){return t.lift(new hi(t))}},hi=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var i=this.connectable;i._refCount++;var r=new pi(t,i),o=e.subscribe(r);return r.closed||(r.connection=i.connect()),o},t}(),pi=function(i){function t(t,e){i.call(this,t),this.connectable=e}return ci(t,i),t.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,1<e)this.connection=null;else{var i=this.connection,r=t._connection;this.connection=null,!r||i&&r!==i||r.unsubscribe()}}else this.connection=null},t}(C.Subscriber),ai={refCount:ui},li=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},fi=(function(i){function t(t,e){i.call(this),this.source=t,this.subjectFactory=e,this._refCount=0,this._isComplete=!1}li(t,i),t.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},t.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new v.Subscription).add(this.source.subscribe(new fi(this.getSubject(),this))),t.closed?(this._connection=null,t=v.Subscription.EMPTY):this._connection=t),t},t.prototype.refCount=function(){return ai.refCount()(this)}}(B.Observable),function(i){function t(t,e){i.call(this,t),this.connectable=e}return li(t,i),t.prototype._error=function(t){this._unsubscribe(),i.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),i.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},t}(ze.SubjectSubscriber)),bi=(function(i){function t(t,e){i.call(this,t),this.connectable=e}li(t,i),t.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,1<e)this.connection=null;else{var i=this.connection,r=t._connection;this.connection=null,!r||i&&r!==i||r.unsubscribe()}}else this.connection=null}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),di=(function(i){function t(t,e){i.call(this,t),this.destination=t,this.nextSources=e}bi(t,i),t.prototype.notifyError=function(t,e){this.subscribeToNextSource()},t.prototype.notifyComplete=function(t){this.subscribeToNextSource()},t.prototype._error=function(t){this.subscribeToNextSource()},t.prototype._complete=function(){this.subscribeToNextSource()},t.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();t?this.add($.subscribeToResult(this,t)):this.destination.complete()}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),yi=(function(e){function t(t){e.call(this,t),this.hasPrev=!1}di(t,e),t.prototype._next=function(t){this.hasPrev?this.destination.next([this.prev,t]):this.hasPrev=!0,this.prev=t}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),vi=(function(i){function t(t){i.call(this),this._value=t}yi(t,i),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var e=i.prototype._subscribe.call(this,t);return e&&!e.closed&&t.next(this._value),e},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ce.ObjectUnsubscribedError;return this._value},t.prototype.next=function(t){i.prototype.next.call(this,this._value=t)}}(ze.Subject),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),_i=(function(e){function t(){e.apply(this,arguments),this.value=null,this.hasNext=!1,this.hasCompleted=!1}vi(t,e),t.prototype._subscribe=function(t){return this.hasError?(t.error(this.thrownError),v.Subscription.EMPTY):this.hasCompleted&&this.hasNext?(t.next(this.value),t.complete(),v.Subscription.EMPTY):e.prototype._subscribe.call(this,t)},t.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},t.prototype.error=function(t){this.hasCompleted||e.prototype.error.call(this,t)},t.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)}}(ze.Subject),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),xi={QueueAction:function(r){function t(t,e){r.call(this,t,e),this.scheduler=t,this.work=e}return _i(t,r),t.prototype.schedule=function(t,e){return void 0===e&&(e=0),0<e?r.prototype.schedule.call(this,t,e):(this.delay=e,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,e){return 0<e||this.closed?r.prototype.execute.call(this,t,e):this._execute(t,e)},t.prototype.requestAsyncId=function(t,e,i){return void 0===i&&(i=0),null!==i&&0<i||null===i&&0<this.delay?r.prototype.requestAsyncId.call(this,t,e,i):t.flush(this)},t}(K.AsyncAction)},wi=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},mi=new({QueueScheduler:function(t){function e(){t.apply(this,arguments)}return wi(e,t),e}(H.AsyncScheduler)}.QueueScheduler)(xi.QueueAction),Si=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Oi=function(r){function t(t,e,i){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===e&&(e=Number.POSITIVE_INFINITY),r.call(this),this.scheduler=i,this._events=[],this._bufferSize=t<1?1:t,this._windowTime=e<1?1:e}return Si(t,r),t.prototype.next=function(t){var e=this._getNow();this._events.push(new gi(e,t)),this._trimBufferThenGetEvents(),r.prototype.next.call(this,t)},t.prototype._subscribe=function(t){var e,i=this._trimBufferThenGetEvents(),r=this.scheduler;if(this.closed)throw new Ce.ObjectUnsubscribedError;this.hasError?e=v.Subscription.EMPTY:this.isStopped?e=v.Subscription.EMPTY:(this.observers.push(t),e=new Ve.SubjectSubscription(this,t)),r&&t.add(t=new Dt.ObserveOnSubscriber(t,r));for(var o=i.length,n=0;n<o&&!t.closed;n++)t.next(i[n].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},t.prototype._getNow=function(){return(this.scheduler||mi).now()},t.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,i=this._windowTime,r=this._events,o=r.length,n=0;n<o&&!(t-r[n].time<i);)n++;return e<o&&(n=Math.max(n,o-e)),0<n&&r.splice(0,n),r},t}(ze.Subject),gi=function(t,e){this.time=t,this.value=e},ji={ReplaySubject:Oi},Ei=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ti=(function(e){function t(t){e.call(this,t),this.hasFirst=!1,this.observables=[],this.subscriptions=[]}Ei(t,e),t.prototype._next=function(t){this.observables.push(t)},t.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var i=0;i<e&&!this.hasFirst;i++){var r=t[i],o=$.subscribeToResult(this,r,r,i);this.subscriptions&&this.subscriptions.push(o),this.add(o)}this.observables=null}},t.prototype.notifyNext=function(t,e,i,r,o){if(!this.hasFirst){this.hasFirst=!0;for(var n=0;n<this.subscriptions.length;n++)if(n!==i){var s=this.subscriptions[n];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(e)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Pi=(function(r){function t(t,e,i){r.call(this,t),this.count=e,this.source=i}Ti(t,r),t.prototype.complete=function(){if(!this.isStopped){var t=this.source,e=this.count;if(0===e)return r.prototype.complete.call(this);-1<e&&(this.count=e-1),t.subscribe(this._unsubscribeAndRecycle())}}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ci=(function(r){function t(t,e,i){r.call(this,t),this.notifier=e,this.source=i,this.sourceIsBeingSubscribedTo=!0}Pi(t,r),t.prototype.notifyNext=function(t,e,i,r,o){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},t.prototype.notifyComplete=function(t){if(!1===this.sourceIsBeingSubscribedTo)return r.prototype.complete.call(this)},t.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return r.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next()}},t.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype._unsubscribeAndRecycle=function(){var t=this.notifications,e=this.retries,i=this.retriesSubscription;return this.notifications=null,this.retries=null,this.retriesSubscription=null,r.prototype._unsubscribeAndRecycle.call(this),this.notifications=t,this.retries=e,this.retriesSubscription=i,this},t.prototype.subscribeToRetries=function(){this.notifications=new ze.Subject;var t=l.tryCatch(this.notifier)(this.notifications);if(t===a.errorObject)return r.prototype.complete.call(this);this.retries=t,this.retriesSubscription=$.subscribeToResult(this,t)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ni=(function(r){function t(t,e,i){r.call(this,t),this.count=e,this.source=i}Ci(t,r),t.prototype.error=function(t){if(!this.isStopped){var e=this.source,i=this.count;if(0===i)return r.prototype.error.call(this,t);-1<i&&(this.count=i-1),e.subscribe(this._unsubscribeAndRecycle())}}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Vi=(function(o){function t(t,e,i){o.call(this,t),this.notifier=e,this.source=i}Ni(t,o),t.prototype.error=function(t){if(!this.isStopped){var e=this.errors,i=this.retries,r=this.retriesSubscription;if(i)this.errors=null,this.retriesSubscription=null;else{if(e=new ze.Subject,(i=l.tryCatch(this.notifier)(e))===a.errorObject)return o.prototype.error.call(this,a.errorObject.e);r=$.subscribeToResult(this,i)}this._unsubscribeAndRecycle(),this.errors=e,this.retries=i,this.retriesSubscription=r,e.next(t)}},t.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),e&&(e.unsubscribe(),this.retriesSubscription=null),this.retries=null},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.errors,s=this.retries,c=this.retriesSubscription;this.errors=null,this.retries=null,this.retriesSubscription=null,this._unsubscribeAndRecycle(),this.errors=n,this.retries=s,this.retriesSubscription=c,this.source.subscribe(this)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ri=(function(t){function e(){t.apply(this,arguments),this.hasValue=!1}Vi(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(t,e,i,r,o){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(r){function t(t,e,i){r.call(this,t),this.period=e,this.scheduler=i,this.hasValue=!1,this.add(i.schedule(Ii,e,{subscriber:this,period:e}))}Ri(t,r),t.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},t.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))}}(C.Subscriber);function Ii(t){var e=t.subscriber,i=t.period;e.notifyNext(),this.schedule(t,i)}var ki=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Ai=(function(r){function t(t,e,i){r.call(this,t),this.compareTo=e,this.comparor=i,this._a=[],this._b=[],this._oneComplete=!1,this.add(e.subscribe(new Ai(t,this)))}ki(t,r),t.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},t.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},t.prototype.checkValues=function(){for(var t=this._a,e=this._b,i=this.comparor;0<t.length&&0<e.length;){var r=t.shift(),o=e.shift(),n=!1;i?(n=l.tryCatch(i)(r,o))===a.errorObject&&this.destination.error(a.errorObject.e):n=r===o,n||this.emit(!1)}},t.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},t.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())}}(C.Subscriber),function(i){function t(t,e){i.call(this,t),this.parent=e}return ki(t,i),t.prototype._next=function(t){this.parent.nextB(t)},t.prototype._error=function(t){this.parent.error(t)},t.prototype._complete=function(){this.parent._complete()},t}(C.Subscriber));var Mi={shareReplay:function(e,p,a){return function(t){return t.lift((i=e,r=p,o=a,c=0,h=u=!1,function(t){c++,n&&!u||(u=!1,n=new ji.ReplaySubject(i,r,o),s=t.subscribe({next:function(t){n.next(t)},error:function(t){u=!0,n.error(t)},complete:function(){h=!0,n.complete()}}));var e=n.subscribe(this);return function(){c--,e.unsubscribe(),s&&0===c&&h&&s.unsubscribe()}}));var i,r,o,n,s,c,u,h}}},Fi=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},zi=(function(r){function t(t,e,i){r.call(this,t),this.predicate=e,this.source=i,this.seenValue=!1,this.index=0}Fi(t,r),t.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},t.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},t.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(i){this.destination.error(i)}},t.prototype._complete=function(){var t=this.destination;0<this.index?(t.next(this.seenValue?this.singleValue:undefined),t.complete()):t.error(new Ee.EmptyError)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Bi=(function(i){function t(t,e){i.call(this,t),this.total=e,this.count=0}zi(t,i),t.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Di=(function(i){function t(t,e){i.call(this,t),this._skipCount=e,this._count=0,this._ring=new Array(e)}Bi(t,i),t.prototype._next=function(t){var e=this._skipCount,i=this._count++;if(i<e)this._ring[i]=t;else{var r=i%e,o=this._ring,n=o[r];o[r]=t,this.destination.next(n)}}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Ui=(function(i){function t(t,e){i.call(this,t),this.hasValue=!1,this.isInnerStopped=!1,this.add($.subscribeToResult(this,e))}Di(t,i),t.prototype._next=function(t){this.hasValue&&i.prototype._next.call(this,t)},t.prototype._complete=function(){this.isInnerStopped?i.prototype._complete.call(this):this.unsubscribe()},t.prototype.notifyNext=function(t,e,i,r,o){this.hasValue=!0},t.prototype.notifyComplete=function(){this.isInnerStopped=!0,this.isStopped&&i.prototype._complete.call(this)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Wi=(function(i){function t(t,e){i.call(this,t),this.predicate=e,this.skipping=!0,this.index=0}Ui(t,i),t.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},t.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(i){this.destination.error(i)}}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),$i=(function(r){function t(t,e,i){r.call(this,t),this.project=e,this.resultSelector=i,this.index=0}Wi(t,r),t.prototype._next=function(t){var e,i=this.index++;try{e=this.project(t,i)}catch(r){return void this.destination.error(r)}this._innerSub(e,t,i)},t.prototype._innerSub=function(t,e,i){var r=this.innerSubscription;r&&r.unsubscribe(),this.add(this.innerSubscription=$.subscribeToResult(this,t,e,i))},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.remove(t),this.innerSubscription=null,this.isStopped&&r.prototype._complete.call(this)},t.prototype.notifyNext=function(t,e,i,r,o){this.resultSelector?this._tryNotifyNext(t,e,i,r):this.destination.next(e)},t.prototype._tryNotifyNext=function(t,e,i,r){var o;try{o=this.resultSelector(t,e,i,r)}catch(n){return void this.destination.error(n)}this.destination.next(o)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Yi=(function(r){function t(t,e,i){r.call(this,t),this.inner=e,this.resultSelector=i,this.index=0}$i(t,r),t.prototype._next=function(t){var e=this.innerSubscription;e&&e.unsubscribe(),this.add(this.innerSubscription=$.subscribeToResult(this,this.inner,t,this.index++))},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||r.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.remove(t),this.innerSubscription=null,this.isStopped&&r.prototype._complete.call(this)},t.prototype.notifyNext=function(t,e,i,r,o){var n=this.resultSelector,s=this.destination;n?this.tryResultSelector(t,e,i,r):s.next(e)},t.prototype.tryResultSelector=function(t,e,i,r){var o,n=this.resultSelector,s=this.destination;try{o=n(t,e,i,r)}catch(c){return void s.error(c)}s.next(o)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var qi=function(e){return function(t){return 0===e?new yt.EmptyObservable:t.lift(new Li(e))}},Li=function(){function t(t){if(this.total=t,this.total<0)throw new le.ArgumentOutOfRangeError}return t.prototype.call=function(t,e){return e.subscribe(new Gi(t,this.total))},t}(),Gi=function(i){function t(t,e){i.call(this,t),this.total=e,this.count=0}return Yi(t,i),t.prototype._next=function(t){var e=this.total,i=++this.count;i<=e&&(this.destination.next(t),i===e&&(this.destination.complete(),this.unsubscribe()))},t}(C.Subscriber),Ki={take:qi},Qi=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};var Ji=function(e){return function(t){return t.lift(new Hi(e))}},Hi=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Zi(t,this.notifier))},t}(),Zi=function(i){function t(t,e){i.call(this,t),this.notifier=e,this.add($.subscribeToResult(this,e))}return Qi(t,i),t.prototype.notifyNext=function(t,e,i,r,o){this.complete()},t.prototype.notifyComplete=function(){},t}(V.OuterSubscriber),Xi={takeUntil:Ji},tr=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},er=(function(i){function t(t,e){i.call(this,t),this.predicate=e,this.index=0}tr(t,i),t.prototype._next=function(t){var e,i=this.destination;try{e=this.predicate(t,this.index++)}catch(r){return void i.error(r)}this.nextOrComplete(t,e)},t.prototype.nextOrComplete=function(t,e){var i=this.destination;Boolean(e)?i.next(t):i.complete()}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});var ir=function(e,i,r){return function(t){return t.lift(new rr(e,i,r))}},rr=function(){function t(t,e,i){this.nextOrObserver=t,this.error=e,this.complete=i}return t.prototype.call=function(t,e){return e.subscribe(new or(t,this.nextOrObserver,this.error,this.complete))},t}(),or=function(n){function t(t,e,i,r){n.call(this,t);var o=new C.Subscriber(e,i,r);o.syncErrorThrowable=!0,this.add(o),this.safeSubscriber=o}return er(t,n),t.prototype._next=function(t){var e=this.safeSubscriber;e.next(t),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.next(t)},t.prototype._error=function(t){var e=this.safeSubscriber;e.error(t),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.error(t)},t.prototype._complete=function(){var t=this.safeSubscriber;t.complete(),t.syncErrorThrown?this.destination.error(t.syncErrorValue):this.destination.complete()},t}(C.Subscriber),nr={tap:ir},sr=s(function(t,r){var e=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)};r.defaultThrottleConfig={leading:!0,trailing:!1},r.throttle=function(e,i){return void 0===i&&(i=r.defaultThrottleConfig),function(t){return t.lift(new o(e,i.leading,i.trailing))}};var o=function(){function t(t,e,i){this.durationSelector=t,this.leading=e,this.trailing=i}return t.prototype.call=function(t,e){return e.subscribe(new i(t,this.durationSelector,this.leading,this.trailing))},t}(),i=function(o){function t(t,e,i,r){o.call(this,t),this.destination=t,this.durationSelector=e,this._leading=i,this._trailing=r,this._hasTrailingValue=!1}return e(t,o),t.prototype._next=function(t){if(this.throttled)this._trailing&&(this._hasTrailingValue=!0,this._trailingValue=t);else{var e=this.tryDurationSelector(t);e&&this.add(this.throttled=$.subscribeToResult(this,e)),this._leading&&(this.destination.next(t),this._trailing&&(this._hasTrailingValue=!0,this._trailingValue=t))}},t.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(e){return this.destination.error(e),null}},t.prototype._unsubscribe=function(){var t=this.throttled;this._trailingValue,this._hasTrailingValue,this._trailing;this._trailingValue=null,this._hasTrailingValue=!1,t&&(this.remove(t),this.throttled=null,t.unsubscribe())},t.prototype._sendTrailing=function(){var t=this,e=t.destination,i=t.throttled,r=t._trailing,o=t._trailingValue,n=t._hasTrailingValue;i&&r&&n&&(e.next(o),this._trailingValue=null,this._hasTrailingValue=!1)},t.prototype.notifyNext=function(t,e,i,r,o){this._sendTrailing(),this._unsubscribe()},t.prototype.notifyComplete=function(){this._sendTrailing(),this._unsubscribe()},t}(V.OuterSubscriber)}),cr=(sr.defaultThrottleConfig,sr.throttle,n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});!function(n){function t(t,e,i,r,o){n.call(this,t),this.duration=e,this.scheduler=i,this.leading=r,this.trailing=o,this._hasTrailingValue=!1,this._trailingValue=null}cr(t,n),t.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(ur,this.duration,{subscriber:this})),this.leading&&this.destination.next(t))},t.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)}}(C.Subscriber);function ur(t){t.subscriber.clearThrottle()}var hr=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},pr=function(t,e){this.value=t,this.interval=e},ar=(function(i){function t(t,e){i.call(this,t),this.scheduler=e,this.lastTime=0,this.lastTime=e.now()}hr(t,i),t.prototype._next=function(t){var e=this.scheduler.now(),i=e-this.lastTime;this.lastTime=e,this.destination.next(new pr(t,i))}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),lr=(function(e){function t(){var t=e.call(this,"Timeout has occurred");this.name=t.name="TimeoutError",this.stack=t.stack,this.message=t.message}ar(t,e)}(Error),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),fr=(function(n){function e(t,e,i,r,o){n.call(this,t),this.absoluteTimeout=e,this.waitFor=i,this.scheduler=r,this.errorInstance=o,this.action=null,this.scheduleTimeout()}lr(e,n),e.dispatchTimeout=function(t){t.error(t.errorInstance)},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),n.prototype._next.call(this,t)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.errorInstance=null}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),br=(function(n){function e(t,e,i,r,o){n.call(this,t),this.absoluteTimeout=e,this.waitFor=i,this.withObservable=r,this.scheduler=o,this.action=null,this.scheduleTimeout()}fr(e,n),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add($.subscribeToResult(t,e))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),n.prototype._next.call(this,t)},e.prototype._unsubscribe=function(){this.action=null,this.scheduler=null,this.withObservable=null}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),dr=(function(e){function t(t){e.call(this,t),this.window=new ze.Subject,t.next(this.window)}br(t,e),t.prototype.notifyNext=function(t,e,i,r,o){this.openWindow()},t.prototype.notifyError=function(t,e){this._error(t)},t.prototype.notifyComplete=function(t){this._complete()},t.prototype._next=function(t){this.window.next(t)},t.prototype._error=function(t){this.window.error(t),this.destination.error(t)},t.prototype._complete=function(){this.window.complete(),this.destination.complete()},t.prototype._unsubscribe=function(){this.window=null},t.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,i=this.window=new ze.Subject;e.next(i)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),yr=(function(r){function t(t,e,i){r.call(this,t),this.destination=t,this.windowSize=e,this.startWindowEvery=i,this.windows=[new ze.Subject],this.count=0,t.next(this.windows[0])}dr(t,r),t.prototype._next=function(t){for(var e=0<this.startWindowEvery?this.startWindowEvery:this.windowSize,i=this.destination,r=this.windowSize,o=this.windows,n=o.length,s=0;s<n&&!this.closed;s++)o[s].next(t);var c=this.count-r+1;if(0<=c&&c%e==0&&!this.closed&&o.shift().complete(),++this.count%e==0&&!this.closed){var u=new ze.Subject;o.push(u),i.next(u)}},t.prototype._error=function(t){var e=this.windows;if(e)for(;0<e.length&&!this.closed;)e.shift().error(t);this.destination.error(t)},t.prototype._complete=function(){var t=this.windows;if(t)for(;0<t.length&&!this.closed;)t.shift().complete();this.destination.complete()},t.prototype._unsubscribe=function(){this.count=0,this.windows=null}}(C.Subscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),vr=function(e){function t(){e.apply(this,arguments),this._numberOfNextedValues=0}return yr(t,e),t.prototype.next=function(t){this._numberOfNextedValues++,e.prototype.next.call(this,t)},Object.defineProperty(t.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),t}(ze.Subject);!function(h){function t(t,e,i,r,o){h.call(this,t),this.destination=t,this.windowTimeSpan=e,this.windowCreationInterval=i,this.maxWindowSize=r,this.scheduler=o,this.windows=[];var n=this.openWindow();if(null!==i&&0<=i){var s={subscriber:this,window:n,context:null},c={windowTimeSpan:e,windowCreationInterval:i,subscriber:this,scheduler:o};this.add(o.schedule(wr,e,s)),this.add(o.schedule(xr,i,c))}else{var u={subscriber:this,window:n,windowTimeSpan:e};this.add(o.schedule(_r,e,u))}}yr(t,h),t.prototype._next=function(t){for(var e=this.windows,i=e.length,r=0;r<i;r++){var o=e[r];o.closed||(o.next(t),o.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(o))}},t.prototype._error=function(t){for(var e=this.windows;0<e.length;)e.shift().error(t);this.destination.error(t)},t.prototype._complete=function(){for(var t=this.windows;0<t.length;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},t.prototype.openWindow=function(){var t=new vr;return this.windows.push(t),this.destination.next(t),t},t.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)}}(C.Subscriber);function _r(t){var e=t.subscriber,i=t.windowTimeSpan,r=t.window;r&&e.closeWindow(r),t.window=e.openWindow(),this.schedule(t,i)}function xr(t){var e=t.windowTimeSpan,i=t.subscriber,r=t.scheduler,o=t.windowCreationInterval,n={action:this,subscription:null},s={subscriber:i,window:i.openWindow(),context:n};n.subscription=r.schedule(wr,e,s),this.add(n.subscription),this.schedule(t,o)}function wr(t){var e=t.subscriber,i=t.window,r=t.context;r&&r.action&&r.subscription&&r.action.remove(r.subscription),e.closeWindow(i)}var mr=n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},Sr=(function(n){function t(t,e,i){n.call(this,t),this.openings=e,this.closingSelector=i,this.contexts=[],this.add(this.openSubscription=$.subscribeToResult(this,e,e))}mr(t,n),t.prototype._next=function(t){var e=this.contexts;if(e)for(var i=e.length,r=0;r<i;r++)e[r].window.next(t)},t.prototype._error=function(t){var e=this.contexts;if(this.contexts=null,e)for(var i=e.length,r=-1;++r<i;){var o=e[r];o.window.error(t),o.subscription.unsubscribe()}n.prototype._error.call(this,t)},t.prototype._complete=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,i=-1;++i<e;){var r=t[i];r.window.complete(),r.subscription.unsubscribe()}n.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,i=-1;++i<e;){var r=t[i];r.window.unsubscribe(),r.subscription.unsubscribe()}},t.prototype.notifyNext=function(t,e,i,r,o){if(t===this.openings){var n=this.closingSelector,s=l.tryCatch(n)(e);if(s===a.errorObject)return this.error(a.errorObject.e);var c=new ze.Subject,u=new v.Subscription,h={window:c,subscription:u};this.contexts.push(h);var p=$.subscribeToResult(this,s,h);p.closed?this.closeWindow(this.contexts.length-1):(p.context=h,u.add(p)),this.destination.next(c)}else this.closeWindow(this.contexts.indexOf(t))},t.prototype.notifyError=function(t){this.error(t)},t.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},t.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,i=e[t],r=i.window,o=i.subscription;e.splice(t,1),r.complete(),o.unsubscribe()}}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),Or=(function(i){function t(t,e){i.call(this,t),this.destination=t,this.closingSelector=e,this.openWindow()}Sr(t,i),t.prototype.notifyNext=function(t,e,i,r,o){this.openWindow(o)},t.prototype.notifyError=function(t,e){this._error(t)},t.prototype.notifyComplete=function(t){this.openWindow(t)},t.prototype._next=function(t){this.window.next(t)},t.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},t.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},t.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},t.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var i=this.window=new ze.Subject;this.destination.next(i);var r=l.tryCatch(this.closingSelector)();if(r===a.errorObject){var o=a.errorObject.e;this.destination.error(o),this.window.error(o)}else this.add(this.closingNotification=$.subscribeToResult(this,r))}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),gr=(function(s){function t(t,e,i){s.call(this,t),this.observables=e,this.project=i,this.toRespond=[];var r=e.length;this.values=new Array(r);for(var o=0;o<r;o++)this.toRespond.push(o);for(o=0;o<r;o++){var n=e[o];this.add($.subscribeToResult(this,n,n,o))}}Or(t,s),t.prototype.notifyNext=function(t,e,i,r,o){this.values[i]=e;var n=this.toRespond;if(0<n.length){var s=n.indexOf(i);-1!==s&&n.splice(s,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},t.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}(V.OuterSubscriber),n&&n.__extends||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);function r(){this.constructor=t}t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),jr=(function(r){function t(t,e,i){void 0===i&&(i=Object.create(null)),r.call(this,t),this.iterators=[],this.active=0,this.project="function"==typeof e?e:null,this.values=i}gr(t,r),t.prototype._next=function(t){var e=this.iterators;f.isArray(t)?e.push(new Er(t)):"function"==typeof t[D.iterator]?e.push(new jr(t[D.iterator]())):e.push(new Tr(this.destination,this,t))},t.prototype._complete=function(){var t=this.iterators,e=t.length;if(0!==e){this.active=e;for(var i=0;i<e;i++){var r=t[i];r.stillUnsubscribed?this.add(r.subscribe(r,i)):this.active--}}else this.destination.complete()},t.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},t.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,i=this.destination,r=0;r<e;r++){if("function"==typeof(s=t[r]).hasValue&&!s.hasValue())return}var o=!1,n=[];for(r=0;r<e;r++){var s,c=(s=t[r]).next();if(s.hasCompleted()&&(o=!0),c.done)return void i.complete();n.push(c.value)}this.project?this._tryProject(n):i.next(n),o&&i.complete()},t.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(i){return void this.destination.error(i)}this.destination.next(e)}}(C.Subscriber),function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return t&&t.done},t}()),Er=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[D.iterator]=function(){return this},t.prototype.next=function(t){var e=this.index++,i=this.array;return e<this.length?{value:i[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),Tr=function(r){function t(t,e,i){r.call(this,t),this.parent=e,this.observable=i,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}return gr(t,r),t.prototype[D.iterator]=function(){return this},t.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},t.prototype.hasValue=function(){return 0<this.buffer.length},t.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},t.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},t.prototype.notifyNext=function(t,e,i,r,o){this.buffer.push(e),this.parent.checkIterators()},t.prototype.subscribe=function(t,e){return $.subscribeToResult(this,this.observable,this,e)},t}(V.OuterSubscriber),Pr=Jt.debounceTime,Cr=pe.distinctUntilChanged,Nr=Se.filter,Vr=ti.map,Rr=Mi.shareReplay,Ir=Ki.take,kr=Xi.takeUntil,Ar=nr.tap;sr.throttle;function Mr(i){return o.Observable.create(function(e){var t=i(function(t){e.next(t)});return function(){return t.dispose()}})}var Fr=new i.InjectionToken("Completion Provider"),zr=new i.InjectionToken("Monaco Editor Options"),Br=function(){function t(t,e,i){this.completionProviders=t,this.editorOptions=e,this.zone=i,this.onFileChange=new r.Subject,this.fileChange$=this.onFileChange.asObservable(),this.bootstrap$=o.Observable.create(function(t){var e=document.createElement("script");e.type="text/javascript",e.src="libs/vs/loader.js",e.onload=function(){window.require.config({paths:{vs:"libs/vs"}}),window.require(["vs/editor/editor.main"],function(){t.next()})},document.body.appendChild(e)}).pipe(Rr(1))}return Object.defineProperty(t.prototype,"editor",{get:function(){return this.monacoEditor},enumerable:!0,configurable:!0}),t.prototype.setDefaultJavascriptCompilerOptions=function(t){monaco.languages.typescript.javascriptDefaults.setCompilerOptions(t)},t.prototype.addDefaultJavascriptExtraLib=function(t,e){monaco.languages.typescript.javascriptDefaults.addExtraLib(t,e)},t.prototype.registerCompletionProviders=function(){if(this.completionProviders)for(var t=0,e=this.completionProviders;t<e.length;t++){var i=e[t];monaco.languages.registerCompletionItemProvider(i.language,i)}},t.prototype.registerModelChangeListener=function(e,t){var i=this,r=Mr(t.onWillDispose.bind(t)).pipe(Ir(1));Mr(t.onDidChangeContent.bind(t)).pipe(Vr(function(){return t.getValue()}),kr(r)).subscribe(function(t){i.zone.run(function(){i.onFileChange.next(Object.assign({},e,{content:t}))})})},t.prototype.disposeModels=function(){if(window.monaco)for(var t=0,e=monaco.editor.getModels();t<e.length;t++){e[t].dispose()}},t.prototype.load=function(t,e){var i=this;void 0===e&&(e={});var r=e.editor||this.editorOptions||{};return this.bootstrap$.pipe(Ar(function(){i.disposeModels(),i.monacoEditor=monaco.editor.create(t.nativeElement,Object.assign({theme:e.theme},r)),i.registerCompletionProviders(),i.file&&i.open(i.file)}))},t.prototype.open=function(t){if(this.file=t,this.monacoEditor){var e=monaco.Uri.file(t.uri),i=monaco.editor.getModel(e);i&&(t.language&&i.getModeId()!==t.language?(i.dispose(),i=undefined):i.setValue(t.content)),i||(i=monaco.editor.createModel(t.content,t.language,e),this.registerModelChangeListener(t,i)),this.monacoEditor.setModel(i)}},t.prototype.updateOptions=function(t){this.monacoEditor&&this.monacoEditor.updateOptions(t)},t.prototype.setTheme=function(t){window.monaco&&monaco.editor.setTheme(t)},t}();Br.decorators=[{type:i.Injectable}],Br.ctorParameters=function(){return[{type:Array,decorators:[{type:i.Optional},{type:i.Inject,args:[Fr]}]},{type:undefined,decorators:[{type:i.Optional},{type:i.Inject,args:[zr]}]},{type:i.NgZone}]};var Dr=function(){function t(t,e){this.monacoEditorService=t,this.editorRef=e,this.ready=new i.EventEmitter,this.fileChange=new i.EventEmitter,this.resize$=new r.Subject,this.destroy$=new r.Subject}return t.prototype.onResize=function(){this.resize$.next()},t.prototype.open=function(t){this.monacoEditorService.open(t)},t.prototype.ngOnInit=function(){var e=this;this.monacoEditorService.load(this.editorRef,{theme:this.theme,editor:this.options}).subscribe(function(){e.ready.emit()}),this.monacoEditorService.fileChange$.pipe(kr(this.destroy$)).subscribe(function(t){e.fileChange.emit(t)}),this.resize$.pipe(Nr(function(){return Boolean(e.monacoEditorService.editor)}),Vr(function(){return{width:e.editorRef.nativeElement.clientWidth,height:e.editorRef.nativeElement.clientHeight}}),Cr(function(t,e){return t.width===e.width&&t.height===e.height}),Pr(50),kr(this.destroy$)).subscribe(function(t){e.monacoEditorService.editor.layout(t)})},t.prototype.ngOnDestroy=function(){this.destroy$.next()},t.prototype.ngOnChanges=function(t){t.options&&this.monacoEditorService.updateOptions(t.options.currentValue),t.theme&&this.monacoEditorService.setTheme(t.theme.currentValue),t.file&&this.open(t.file.currentValue)},t.prototype.ngAfterViewChecked=function(){this.resize$.next()},t}();Dr.decorators=[{type:i.Directive,args:[{selector:"monaco-editor,[monaco-editor]"}]}],Dr.ctorParameters=function(){return[{type:Br},{type:i.ElementRef}]},Dr.propDecorators={theme:[{type:i.Input}],file:[{type:i.Input}],options:[{type:i.Input}],ready:[{type:i.Output}],fileChange:[{type:i.Output}],onResize:[{type:i.HostListener,args:["window:resize"]}]};var Ur=function(){function e(){}return e.forRoot=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[Br,{provide:zr,useValue:t.options||{}}]}},e}();Ur.decorators=[{type:i.NgModule,args:[{imports:[e.CommonModule],declarations:[Dr],exports:[Dr]}]}],Ur.ctorParameters=function(){return[]},t.MonacoEditorModule=Ur,t.MonacoEditorDirective=Dr,t.MonacoEditorService=Br,t.COMPLETION_PROVIDERS=Fr,t.MONACO_EDITOR_OPTIONS=zr,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-monaco.umd.min.js.map
